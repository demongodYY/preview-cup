webpackJsonp([1],{"/IO3":function(e,t){e.exports=[{name:"layout1",url:"/static/img/layout1.png"},{name:"layout2",url:"/static/img/layout2.png"},{name:"layout3",url:"/static/img/layout3.png"}]},EjwQ:function(e,t){},H9h6:function(e,t){e.exports=[{name:"background1",url:"/static/img/bg1.png"},{name:"background2",url:"/static/img/bg2.png"}]},NHnr:function(e,t,n){"use strict";function a(e){n("qH7m")}function i(e){n("EjwQ")}function r(e){n("cff8")}function o(e){n("jSAi")}Object.defineProperty(t,"__esModule",{value:!0});var s=n("TWX9"),l=n("z5U/"),u=n.n(l),c=(n("rK6t"),n("S3zW")),d=n.n(c),p={name:"cupCanvas",data:function(){return{textShow:!1,layer:""}},methods:{saveImage:function(e){var t=e.toDataURL();this.$root.bus.$emit("canvasChange",t)},inputText:function(e){var t=this,n=this.$refs.textarea,a=e.position();n.value=e.text(),n.style.position="absolute",n.style.fontSize=e.fontSize()+"px",n.style.fontFamily=e.fontFamily(),n.style.width=e.width()+"px",n.style.height=e.height()+"px",n.style.top=a.y+"px",n.style.left=a.x+"px",n.style["z-index"]=1,this.textShow=!0,n.addEventListener("keydown",function(a){13===a.keyCode&&(e.text(n.value),t.layer.draw(),t.textShow=!1,t.saveImage(t.layer))})},drawImage:function(e){var t=this,n=new Image;n.src=e,n.onload=function(){var e=new d.a.Image({name:"img",image:n,width:200,height:200,x:t.layer.getWidth()/2-100,y:100,draggable:!0}),a=new d.a.Group({clipFunc:function(e){e.arc(t.layer.getWidth()/2,200,100,0,2*Math.PI)}});a.add(e),t.layer.add(a),t.layer.draw(),t.saveImage(t.layer)}},uploadImage:function(){var e=this,t=document.getElementById("fileup");t.onchange=function(){var n=new FileReader;n.onload=function(t){e.drawImage(t.target.result)},n.readAsDataURL(t.files[0])}},addShapes:function(){var e=this,t=new d.a.Circle({x:this.layer.getWidth()/2,y:200,radius:100,stroke:"blue",strokeWidth:1}),n=new d.a.Text({x:this.layer.getWidth()/2-100,y:400,width:200,height:100,stroke:"blue",strokeWidth:1,text:"Hello World!",fontSize:30,fontFamily:"Calibri"});n.on("click",function(){e.inputText(n)}),this.layer.add(t),this.layer.add(n),this.layer.draw()}},mounted:function(){var e=this,t=new d.a.Stage({container:"myCanvas",width:800,height:600}),n=new d.a.Layer;this.layer=n,t.add(n),this.$root.bus.$on("bgChange",function(t){n.find(".background").destroy();var a=new Image;a.src=t,a.onload=function(){var t=new d.a.Image({name:"background",image:a});n.add(t),t.moveToBottom(),n.draw(),e.saveImage(e.layer)}}),this.addShapes(),this.uploadImage()}},g=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"container"}},[n("textarea",{directives:[{name:"show",rawName:"v-show",value:e.textShow,expression:"textShow"}],ref:"textarea",attrs:{autofocus:""}}),e._v(" "),n("div",{attrs:{id:"myCanvas"}}),e._v(" "),n("input",{attrs:{type:"file",id:"fileup"}}),e._v(" "),n("el-button",{attrs:{plain:"",disabled:""}},[e._v("上一步")]),e._v(" "),n("el-button",{attrs:{plain:"",disabled:""}},[e._v("下一步")]),e._v(" "),n("el-button",{attrs:{plain:"",disabled:""}},[e._v("清空重做")])],1)},h=[],m={render:g,staticRenderFns:h},f=m,v=n("/Xao"),y=a,b=v(p,f,!1,y,"data-v-57e4a857",null),w=b.exports,x=n("Lsr5"),_={name:"preview",data:function(){return{scene:null,camera:null,renderer:null}},methods:{initScene:function(){var e=document.getElementById("p-container");this.scene=new x.f,this.scene.background=new x.a,this.camera=new x.e(75,e.clientWidth/window.innerHeight,.1,1e3),this.renderer=new x.h,this.renderer.setSize(e.clientWidth,window.innerHeight),e.appendChild(this.renderer.domElement)},renderCup:function(){var e=this,t=new x.b(1,1,5,32),n=(new x.g).load("/static/img/bg1.png",function(a){var i=new x.d({map:n});n.needsUpdate=!0;var r=new x.c(t,i);e.scene.add(r),e.camera.position.z=6;!function t(){requestAnimationFrame(t),r.rotation.y+=.01,e.renderer.render(e.scene,e.camera)}(),e.$root.bus.$on("canvasChange",function(t){e.updateTexture(r,t)})})},updateTexture:function(e,t){e.material.map=(new x.g).load(t),e.material.needsUpdate=!0}},mounted:function(){this.initScene(),this.renderCup()}},k=function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{staticClass:"container",attrs:{id:"p-container"}})},L=[],I={render:k,staticRenderFns:L},S=I,C=n("/Xao"),$=i,W=C(_,S,!1,$,"data-v-942e3e2e",null),E=W.exports,F=n("H9h6"),H=n("/IO3"),z={name:"cup",components:{myCanvas:w,preview:E},methods:{changeBackground:function(e){this.bgUrl=this.bgList[e].url,this.bgListVisible=!1,this.$root.bus.$emit("bgChange",this.bgUrl)}},beforeMount:function(){this.bgList=F,this.layoutList=H},mounted:function(){this.changeBackground(0)},data:function(){return{bgListVisible:!1,bgList:[],bgUrl:"",layoutListVisible:!1,layoutList:[]}}},T=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"cup"},[n("el-popover",{ref:"bg-popup",attrs:{placement:"right",trigger:"click",width:"400"},model:{value:e.bgListVisible,callback:function(t){e.bgListVisible=t},expression:"bgListVisible"}},[n("el-row",{attrs:{gutter:24}},e._l(e.bgList,function(t,a){return n("el-col",{key:a,attrs:{span:12}},[n("el-button",{on:{click:function(t){e.changeBackground(a)}}},[n("img",{attrs:{src:t.url,alt:"背景图"+a}})])],1)}))],1),e._v(" "),n("el-popover",{ref:"layout-popup",attrs:{placement:"right",trigger:"click",width:"400"}},[n("el-row",{attrs:{gutter:24}},e._l(e.layoutList,function(t,a){return n("el-col",{key:a,attrs:{span:12}},[n("el-button",{on:{click:function(t){e.changeBackground(a)}}},[n("img",{attrs:{src:t.url,alt:"layout"+a}})])],1)}))],1),e._v(" "),n("el-container",[n("el-aside",[n("ul",[n("li",[n("el-button",{directives:[{name:"popover",rawName:"v-popover:bg-popup",arg:"bg-popup"}],attrs:{plain:""}},[e._v("更换背景")])],1),e._v(" "),n("li",[n("el-button",{directives:[{name:"popover",rawName:"v-popover:layout-popup",arg:"layout-popup"}],attrs:{plain:"",disabled:"true"}},[e._v("更换布局")])],1)])]),e._v(" "),n("el-main",[n("my-canvas")],1),e._v(" "),n("el-aside",[n("preview")],1)],1)],1)},U=[],B={render:T,staticRenderFns:U},R=B,A=n("/Xao"),V=r,j=A(z,R,!1,V,"data-v-b805e61e",null),N=j.exports,X={name:"app",components:{cup:N}},q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("cup")],1)},M=[],O={render:q,staticRenderFns:M},D=O,K=n("/Xao"),P=o,Q=K(X,D,!1,P,null,null),G=Q.exports;s.default.config.productionTip=!1,s.default.use(u.a),new s.default({el:"#app",template:"<App/>",components:{App:G},data:{bus:new s.default}})},cff8:function(e,t){},jSAi:function(e,t){},qH7m:function(e,t){},rK6t:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.1558ea0e10c9386aa36c.js.map