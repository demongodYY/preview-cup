webpackJsonp([1],{"/IO3":function(t,e){t.exports=[{name:"layout1",url:"./static/img/layout1.png",layout:{img:[{type:"circle",x:200,y:200,r:130}],text:[{x:450,y:200,width:200,height:100}]}},{name:"layout2",url:"./static/img/layout2.png",layout:{img:[{type:"circle",x:250,y:200,r:100},{type:"circle",x:550,y:200,r:100}],text:[{x:300,y:400,width:200,height:100}]}}]},H9h6:function(t,e){t.exports=[{name:"background1",url:"./static/img/bg1.png"},{name:"background2",url:"./static/img/bg2.png"}]},NHnr:function(t,e,i){"use strict";function a(t){i("u4D0")}function n(t){i("OzmA")}function r(t){i("nEl0")}function o(t){i("jSAi")}Object.defineProperty(e,"__esModule",{value:!0});var s=i("TWX9"),l=i("z5U/"),u=i.n(l),c=(i("rK6t"),i("S3zW")),d=i.n(c),p={name:"cupCanvas",data:function(){return{textShow:!1,layer:"",stage:"",dialogVisible:!1,currentGroup:"",images:[]}},methods:{saveImage:function(){var t=this.stage.toDataURL();this.$root.bus.$emit("canvasChange",t)},inputText:function(t){var e=this,i=this.$refs.textarea,a=t.position();i.value=t.text(),i.style.position="absolute",i.style.fontSize=t.fontSize()+"px",i.style.fontFamily=t.fontFamily(),i.style.width=t.width()+"px",i.style.height=t.height()+"px",i.style.top=a.y+"px",i.style.left=a.x+"px",i.style["z-index"]=1,this.textShow=!0,i.addEventListener("keydown",function(a){13===a.keyCode&&(t.text(i.value),e.layer.draw(),e.textShow=!1,e.saveImage())})},drawImage:function(t){var e=this,i=void 0,a=void 0,n=void 0,r=void 0,o=void 0;this.currentGroup.hasChildren("Circle")?(i=this.currentGroup.findOne("Circle"),a=i.size().width,n=i.size().height,r=i.position().x-a/2,o=i.position().y-n/2):this.currentGroup.hasChildren("Rect")&&(i=this.currentGroup.findOne("Rect"),a=i.size().width,n=i.size().height,r=i.position().x,o=i.position().y);var s=new Image;s.src=t,s.onload=function(){var t=new d.a.Image({name:"img",image:s,width:a,height:n,x:r,y:o,draggable:!0});e.currentGroup.add(t),e.layer.draw(),e.saveImage(),e.dialogVisible=!1}},uploadImage:function(){var t=this,e=document.getElementById("fileup"),i=new FileReader;i.onload=function(e){t.images.push(e.target.result)},i.readAsDataURL(e.files[0])},addImgShapes:function(t){var e=this;if("circle"===t.type){var i=new d.a.Group({clipFunc:function(e){e.arc(t.x,t.y,t.r,0,2*Math.PI)}}),a=new d.a.Circle({x:t.x,y:t.y,radius:t.r,stroke:"black",strokeWidth:2});i.add(a),i.on("click",function(){e.currentGroup=i,e.dialogVisible=!0}),this.layer.add(i),this.layer.draw()}},addTextShapes:function(t){var e=this,i=new d.a.Text({x:t.x,y:t.y,width:t.width,height:t.height,stroke:"blue",strokeWidth:1,text:"点我输入文字",fontSize:30,fontFamily:"Calibri"});i.on("click",function(){e.inputText(i)}),this.layer.add(i),this.layer.draw()}},mounted:function(){var t=this;this.stage=new d.a.Stage({container:"myCanvas",width:800,height:600});var e=new d.a.Layer;this.layer=new d.a.Layer,this.stage.add(e),this.stage.add(this.layer),e.moveToBottom(),this.$root.bus.$on("bgChange",function(i){e.find(".background").destroy();var a=new Image;a.src=i,a.onload=function(){var i=new d.a.Image({name:"background",image:a});e.add(i),i.moveToBottom(),e.draw(),t.saveImage()}}),this.$root.bus.$on("layoutChange",function(e){t.layer.removeChildren(),e.img.map(function(e){t.addImgShapes(e)}),e.text.map(function(e){t.addTextShapes(e)}),t.saveImage()})}},h=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"container"}},[i("el-dialog",{attrs:{title:"图片选择",width:"540",visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("div",{staticClass:"thumbs"},[i("el-row",t._l(t.images,function(e,a){return i("el-col",{key:a,attrs:{span:5}},[i("div",{staticClass:"img-btn"},[i("el-button",{attrs:{type:"success",size:"mini",round:""},on:{click:function(i){t.drawImage(e)}}},[t._v("选择图片")]),t._v(" "),i("br"),t._v(" "),i("el-button",{attrs:{type:"danger",size:"mini",round:""},on:{click:function(e){t.images.splice(a,1)}}},[t._v("删除图片")])],1),t._v(" "),i("img",{staticClass:"savedImg",attrs:{src:e,alt:"保存的图片"+a}})])}))],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("input",{attrs:{type:"file",id:"fileup"},on:{change:t.uploadImage}}),t._v(" "),i("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")])],1)]),t._v(" "),i("textarea",{directives:[{name:"show",rawName:"v-show",value:t.textShow,expression:"textShow"}],ref:"textarea",attrs:{autofocus:""}}),t._v(" "),i("div",{attrs:{id:"myCanvas"}}),t._v(" "),i("el-button",{attrs:{plain:"",disabled:""}},[t._v("上一步")]),t._v(" "),i("el-button",{attrs:{plain:"",disabled:""}},[t._v("下一步")]),t._v(" "),i("el-button",{attrs:{plain:"",disabled:""}},[t._v("清空重做")])],1)},g=[],m={render:h,staticRenderFns:g},v=m,f=i("/Xao"),y=a,b=f(p,v,!1,y,"data-v-6a70c0d2",null),w=b.exports,x=i("Lsr5"),_={name:"preview",data:function(){return{scene:null,camera:null,renderer:null}},methods:{initScene:function(){var t=document.getElementById("p-container");this.scene=new x.h,this.camera=new x.f(45,225/475,1,2e3),this.camera.position.y=400,this.scene.add(this.camera),this.renderer=new x.j({alpha:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(225,475),t.appendChild(this.renderer.domElement);var e=new x.a(16777215,1);this.scene.add(e)},renderCup:function(){var t=this,e=new x.b(155,128,585,40,5,!0),i=(new x.i).load("./static/img/bg1.png",function(a){i.wrapS=i.wrapT=x.g,i.anisotropy=16;var n=new x.e({map:i,side:x.c,opacity:.8,transparent:!0}),r=new x.d(e,n);r.position.set(0,-40,0),t.scene.add(r),t.camera.position.z=800,t.camera.lookAt(t.scene.position);!function e(){requestAnimationFrame(e),r.rotation.y+=.01,t.renderer.render(t.scene,t.camera)}(),t.$root.bus.$on("canvasChange",function(e){t.updateTexture(r,e)})})},updateTexture:function(t,e){t.material.map=(new x.i).load(e),t.material.needsUpdate=!0}},mounted:function(){this.initScene(),this.renderCup()}},k=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0,!1,!1)},C=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"container"}},[i("div",{staticClass:"container",attrs:{id:"p-container"}}),t._v(" "),i("div",{attrs:{id:"images-back"}},[i("img",{attrs:{src:"./static/img/cup-back.png"}})]),t._v(" "),i("div",{attrs:{id:"images-front"}},[i("img",{attrs:{src:"./static/img/cup-front.png"}})])])}],L={render:k,staticRenderFns:C},I=L,S=i("/Xao"),$=n,z=S(_,I,!1,$,"data-v-4b05c604",null),V=z.exports,T=i("H9h6"),E=i("/IO3"),R={name:"cup",components:{myCanvas:w,preview:V},methods:{changeBackground:function(t){this.bgUrl=this.bgList[t].url,this.bgListVisible=!1,this.$root.bus.$emit("bgChange",this.bgUrl)},changeLayout:function(t){this.layout=this.layoutList[t].layout,this.layoutListVisible=!1,this.$root.bus.$emit("layoutChange",this.layout)}},beforeMount:function(){this.bgList=T,this.layoutList=E},mounted:function(){this.changeBackground(0)},data:function(){return{bgListVisible:!1,bgList:[],bgUrl:"",layoutListVisible:!1,layoutList:[],layout:{}}}},F=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"cup"},[i("el-popover",{ref:"bg-popup",attrs:{placement:"right",trigger:"click",width:"400"},model:{value:t.bgListVisible,callback:function(e){t.bgListVisible=e},expression:"bgListVisible"}},[i("el-row",{attrs:{gutter:24}},t._l(t.bgList,function(e,a){return i("el-col",{key:a,attrs:{span:12}},[i("el-button",{on:{click:function(e){t.changeBackground(a)}}},[i("img",{attrs:{src:e.url,alt:"背景图"+a}})])],1)}))],1),t._v(" "),i("el-popover",{ref:"layout-popup",attrs:{placement:"right",trigger:"click",width:"400"},model:{value:t.layoutListVisible,callback:function(e){t.layoutListVisible=e},expression:"layoutListVisible"}},[i("el-row",{attrs:{gutter:24}},t._l(t.layoutList,function(e,a){return i("el-col",{key:a,attrs:{span:12}},[i("el-button",{on:{click:function(e){t.changeLayout(a)}}},[i("img",{attrs:{src:e.url,alt:"layout"+a}})])],1)}))],1),t._v(" "),i("el-container",[i("el-aside",[i("ul",[i("li",[i("el-button",{directives:[{name:"popover",rawName:"v-popover:bg-popup",arg:"bg-popup"}],attrs:{plain:""}},[t._v("更换背景")])],1),t._v(" "),i("li",[i("el-button",{directives:[{name:"popover",rawName:"v-popover:layout-popup",arg:"layout-popup"}],attrs:{plain:""}},[t._v("更换布局")])],1)])]),t._v(" "),i("el-main",[i("my-canvas")],1),t._v(" "),i("el-aside",[i("preview")],1)],1)],1)},A=[],G={render:F,staticRenderFns:A},B=G,O=i("/Xao"),U=r,N=O(R,B,!1,U,"data-v-b72494fa",null),X=N.exports,j={name:"app",components:{cup:X}},D=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("cup")],1)},H=[],P={render:D,staticRenderFns:H},W=P,M=i("/Xao"),K=o,q=M(j,W,!1,K,null,null),J=q.exports;s.default.config.productionTip=!1,s.default.use(u.a),new s.default({el:"#app",template:"<App/>",components:{App:J},data:{bus:new s.default}})},OzmA:function(t,e){},jSAi:function(t,e){},nEl0:function(t,e){},rK6t:function(t,e){},u4D0:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.c5b913c2e5643ae6749f.js.map