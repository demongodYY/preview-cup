webpackJsonp([1],{"/IO3":function(t,e){t.exports=[{name:"layout1",url:"./static/img/layout1.png",layout:{img:[{type:"circle",x:200,y:200,r:130}],text:[{x:450,y:200,width:200,height:100}]}},{name:"layout2",url:"./static/img/layout2.png",layout:{img:[{type:"circle",x:250,y:200,r:100},{type:"circle",x:550,y:200,r:100}],text:[{x:300,y:400,width:200,height:100}]}},{name:"layout3",url:"./static/img/layout3.png",layout:{img:[{type:"circle",x:250,y:240,r:80},{type:"circle",x:390,y:180,r:80},{type:"circle",x:530,y:240,r:80}],text:[{x:300,y:400,width:200,height:100}]}},{name:"layout4",url:"./static/img/layout4.png",layout:{img:[{type:"rect",x:150,y:100,width:200,height:200,rotation:-20},{type:"rect",x:450,y:100,width:200,height:200,rotation:20}],text:[{x:300,y:400,width:200,height:100}]}},{name:"layout5",url:"./static/img/layout5.png",layout:{img:[{type:"circle",x:390,y:180,r:120}],text:[{x:300,y:400,width:200,height:100}]}},{name:"layout6",url:"./static/img/layout6.png",layout:{img:[{type:"circle",x:250,y:200,r:100},{type:"circle",x:550,y:200,r:100}],text:[{x:150,y:400,width:200,height:100},{x:450,y:400,width:200,height:100}]}},{name:"layout7",url:"./static/img/layout7.png",layout:{img:[{type:"rect",x:300,y:100,width:200,height:200,rotation:0}],text:[{x:300,y:400,width:200,height:100}]}},{name:"layout8",url:"./static/img/layout8.png",layout:{img:[{type:"rect",x:150,y:100,width:200,height:200,rotation:0},{type:"rect",x:450,y:100,width:200,height:200,rotation:0}],text:[{x:150,y:400,width:200,height:100},{x:450,y:400,width:200,height:100}]}},{name:"layout9",url:"./static/img/layout9.png",layout:{img:[{type:"rect",x:100,y:150,width:200,height:200,rotation:-15},{type:"rect",x:300,y:100,width:200,height:200,rotation:0},{type:"rect",x:500,y:150,width:200,height:200,rotation:15}],text:[{x:300,y:400,width:200,height:100}]}},{name:"layout10",url:"./static/img/layout10.png",layout:{img:[{type:"rect",x:130,y:130,width:230,height:230,rotation:0}],text:[{x:450,y:200,width:200,height:100}]}}]},"4KRB":function(t,e){},H9h6:function(t,e){t.exports=[{name:"background1",url:"./static/img/bg1.png"},{name:"background2",url:"./static/img/bg2.png"}]},NHnr:function(t,e,i){"use strict";function n(t){i("4KRB")}function a(t){i("wtdT")}function o(t){i("sUZJ")}function r(t){i("jSAi")}Object.defineProperty(e,"__esModule",{value:!0});var l=i("TWX9"),s=i("z5U/"),c=i.n(s),u=(i("rK6t"),i("aA9S")),h=i.n(u),d=i("S3zW"),g=i.n(d),y={name:"cupCanvas",data:function(){return{textShow:!1,inputUrl:"",layout:"",layer:"",stage:"",dialogVisible:!1,currentGroup:"",fontStyle:{fontFamily:"serif",fontSize:30,textAlign:"left",color:"#808080"},fontFamilys:["serif","sans-serif","monospace","cursive","fantasy","system-ui"],images:[]}},methods:{saveImage:function(){var t=this.stage.toDataURL();this.$root.bus.$emit("canvasChange",t)},changeTextStyle:function(){this.fontStyle.fontSize=this.fontStyle.fontSize+"px";var t=this.$refs.textarea;h()(t.style,this.fontStyle)},printText:function(t){var e=this.$refs.textarea,i=e.style.fontSize,n=Number(i.substring(0,i.length-2));t.fontSize(n),t.fontFamily(e.style.fontFamily),t.text(e.value),t.align(e.style.textAlign),t.stroke(e.style.color),this.layer.draw(),this.textShow=!1,this.saveImage()},inputText:function(t){var e=this,i=this.$refs.textarea,n=t.position();i.value=t.text(),i.style.position="absolute",i.style.fontSize=t.fontSize()+"px",i.style.fontFamily=t.fontFamily(),i.style.color=t.stroke(),i.style.textAlign=t.align(),i.style.width=t.width()+"px",i.style.height=t.height()+"px",i.style.top=n.y+"px",i.style.left=n.x+"px",i.style["z-index"]=1,this.textShow=!0,i.addEventListener("keydown",function(i){13===i.keyCode&&e.printText(t)})},drawImage:function(t){var e=this,i=void 0,n=void 0,a=void 0,o=void 0,r=void 0;this.currentGroup.findOne("Circle")?(i=this.currentGroup.findOne("Circle"),n=i.size().width,a=i.size().height,o=i.position().x-n/2,r=i.position().y-a/2):this.currentGroup.findOne("Rect")&&(i=this.currentGroup.findOne("Rect"),n=i.size().width,a=i.size().height,o=i.position().x,r=i.position().y);var l=new Image;l.src=t,l.onload=function(){var t=new g.a.Image({name:"img",image:l,width:n,height:a,x:o,y:r,draggable:!0});e.currentGroup.add(t),e.layer.draw(),e.saveImage(),e.dialogVisible=!1}},uploadImage:function(){var t=this,e=document.getElementById("fileup"),i=new FileReader;i.onload=function(e){t.images.push(e.target.result)},i.readAsDataURL(e.files[0])},addImgShapes:function(t){var e=this,i=void 0,n=void 0;"circle"===t.type?(n=new g.a.Group({clipFunc:function(e){e.arc(t.x,t.y,t.r,0,2*Math.PI)}}),i=new g.a.Circle({x:t.x,y:t.y,radius:t.r,stroke:"black",strokeWidth:2})):"rect"===t.type&&(n=new g.a.Group({clipFunc:function(e){var i=t.x+t.width/2,n=t.y+t.height/2;e.translate(i,n),e.rotate(t.rotation*Math.PI/180),e.translate(-i,-n),e.rect(t.x,t.y,t.width,t.height)}}),i=new g.a.Rect({x:t.x,y:t.y,width:t.width,height:t.height,stroke:"black",strokeWidth:2})),n.add(i),n.on("click",function(){e.currentGroup=n,e.dialogVisible=!0}),this.layer.add(n),this.layer.draw()},addTextShapes:function(t){var e=this,i=new g.a.Text({x:t.x,y:t.y,width:t.width,height:t.height,stroke:"#808080",strokeWidth:1,text:"点我输入文字",fontSize:30,fontFamily:"serif"});i.on("click",function(){e.inputText(i)}),this.layer.add(i),this.layer.draw()}},mounted:function(){var t=this;this.stage=new g.a.Stage({container:"myCanvas",width:800,height:600});var e=new g.a.Layer;this.layer=new g.a.Layer,this.stage.add(e),this.stage.add(this.layer),e.moveToBottom(),this.$root.bus.$on("bgChange",function(i){e.find(".background").destroy();var n=new Image;n.src=i,n.onload=function(){var i=new g.a.Image({name:"background",width:800,height:600,image:n});e.add(i),i.moveToBottom(),e.draw(),t.saveImage()}}),this.$root.bus.$on("layoutChange",function(e){t.layout=e,t.layer.removeChildren(),e.img.map(function(e){t.addImgShapes(e)}),e.text.map(function(e){t.addTextShapes(e)}),t.saveImage()})}},p=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"container"}},[i("el-dialog",{attrs:{title:"图片选择",width:"540",visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("div",{staticClass:"thumbs"},[i("el-row",t._l(t.images,function(e,n){return i("el-col",{key:n,attrs:{span:5}},[i("div",{staticClass:"img-btn"},[i("el-button",{attrs:{type:"success",size:"mini",round:""},on:{click:function(i){t.drawImage(e)}}},[t._v("选择图片")]),t._v(" "),i("br"),t._v(" "),i("el-button",{attrs:{type:"danger",size:"mini",round:""},on:{click:function(e){t.images.splice(n,1)}}},[t._v("删除图片")])],1),t._v(" "),i("img",{staticClass:"savedImg",attrs:{src:e,alt:"保存的图片"+n}})])}))],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-input",{attrs:{placeholder:"手动输入图片URL"},model:{value:t.inputUrl,callback:function(e){t.inputUrl=e},expression:"inputUrl"}},[i("el-button",{attrs:{slot:"append",icon:"el-icon-upload2",size:"small"},on:{click:function(e){t.images.push(t.inputUrl)}},slot:"append"})],1),t._v(" "),i("input",{attrs:{type:"file",id:"fileup",accept:".jpg, .jpeg, .png, .gif"},on:{change:t.uploadImage}}),t._v(" "),i("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")])],1)]),t._v(" "),i("el-popover",{directives:[{name:"show",rawName:"v-show",value:t.textShow,expression:"textShow"}],attrs:{placement:"right",width:"210"}},[i("textarea",{directives:[{name:"show",rawName:"v-show",value:t.textShow,expression:"textShow"}],ref:"textarea",attrs:{slot:"reference",autofocus:""},slot:"reference"}),t._v(" "),i("div",[i("el-select",{on:{change:t.changeTextStyle},model:{value:t.fontStyle.fontFamily,callback:function(e){t.$set(t.fontStyle,"fontFamily",e)},expression:"fontStyle.fontFamily"}},t._l(t.fontFamilys,function(t){return i("el-option",{key:t,attrs:{label:t,value:t}})})),t._v(" "),i("el-color-picker",{on:{change:t.changeTextStyle},model:{value:t.fontStyle.color,callback:function(e){t.$set(t.fontStyle,"color",e)},expression:"fontStyle.color"}}),t._v(" "),i("el-input-number",{attrs:{label:"字体",size:"small"},on:{change:t.changeTextStyle},model:{value:t.fontStyle.fontSize,callback:function(e){t.$set(t.fontStyle,"fontSize",e)},expression:"fontStyle.fontSize"}}),t._v(" "),i("el-radio-group",{attrs:{size:"medium"},on:{change:t.changeTextStyle},model:{value:t.fontStyle.textAlign,callback:function(e){t.$set(t.fontStyle,"textAlign",e)},expression:"fontStyle.textAlign"}},[i("el-radio-button",{attrs:{label:"left"}},[t._v("靠左")]),t._v(" "),i("el-radio-button",{attrs:{label:"center"}},[t._v("居中")]),t._v(" "),i("el-radio-button",{attrs:{label:"right"}},[t._v("靠右")])],1)],1)]),t._v(" "),i("div",{attrs:{id:"myCanvas"}}),t._v(" "),i("el-button",{attrs:{plain:""},on:{click:function(e){t.$root.bus.$emit("layoutChange",t.layout)}}},[t._v("清空重做")])],1)},m=[],f={render:p,staticRenderFns:m},v=f,x=i("/Xao"),w=n,b=x(y,v,!1,w,"data-v-80376c14",null),S=b.exports,_=i("Lsr5"),k={name:"preview",data:function(){return{scene:null,camera:null,renderer:null,cylinderMesh:null,degree:0}},methods:{initScene:function(){var t=document.getElementById("p-container");this.scene=new _.g,this.camera=new _.f(45,225/475,1,2e3),this.camera.position.y=400,this.scene.add(this.camera),this.renderer=new _.i({alpha:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(225,475),t.appendChild(this.renderer.domElement);var e=new _.a(16777215,1);this.scene.add(e)},renderCup:function(){var t=this,e=new _.b(155,128,585,64,5,!0),i=(new _.h).load("./static/img/bg1.png",function(n){i.anisotropy=2;var a=new _.e({map:i,side:_.c,opacity:.8,transparent:!0});t.cylinderMesh=new _.d(e,a),t.cylinderMesh.position.set(0,-40,0),t.scene.add(t.cylinderMesh),t.camera.position.z=800,t.camera.lookAt(t.scene.position);!function e(){requestAnimationFrame(e),t.cylinderMesh.rotation.y=t.degree*Math.PI/180,t.renderer.render(t.scene,t.camera)}(),t.$root.bus.$on("canvasChange",function(e){t.updateTexture(e)})})},updateTexture:function(t){this.cylinderMesh.material.map=(new _.h).load(t),this.cylinderMesh.material.needsUpdate=!0}},mounted:function(){this.initScene(),this.renderCup()}},L=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"container"}},[i("div",{staticClass:"container",attrs:{id:"p-container"}}),t._v(" "),i("div",{attrs:{id:"images-back"}},[i("img",{attrs:{src:"./static/img/cup-back.png"}}),t._v(" "),i("el-slider",{attrs:{max:180,min:-180},model:{value:t.degree,callback:function(e){t.degree=e},expression:"degree"}})],1),t._v(" "),t._m(0,!1,!1)])},$=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"images-front"}},[i("img",{attrs:{src:"./static/img/cup-front.png"}})])}],z={render:L,staticRenderFns:$},C=z,I=i("/Xao"),T=a,F=I(k,C,!1,T,"data-v-db986ce4",null),V=F.exports,R=i("H9h6"),U=i("/IO3"),A={name:"cup",components:{myCanvas:S,preview:V},methods:{changeBackground:function(t){this.bgUrl=this.bgList[t].url,this.bgListVisible=!1,this.$root.bus.$emit("bgChange",this.bgUrl)},changeLayout:function(t){this.layout=this.layoutList[t].layout,this.layoutListVisible=!1,this.$root.bus.$emit("layoutChange",this.layout)}},beforeMount:function(){this.bgList=R,this.layoutList=U},mounted:function(){this.changeBackground(0),this.changeLayout(0)},data:function(){return{bgListVisible:!1,bgList:[],bgUrl:"",layoutListVisible:!1,layoutList:[],layout:{}}}},M=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"cup"},[i("el-popover",{ref:"bg-popup",attrs:{placement:"right",trigger:"click",width:"400"},model:{value:t.bgListVisible,callback:function(e){t.bgListVisible=e},expression:"bgListVisible"}},[i("el-row",{attrs:{gutter:24}},t._l(t.bgList,function(e,n){return i("el-col",{key:n,attrs:{span:12}},[i("el-button",{on:{click:function(e){t.changeBackground(n)}}},[i("img",{attrs:{src:e.url,alt:"背景图"+n}})])],1)}))],1),t._v(" "),i("el-popover",{ref:"layout-popup",attrs:{placement:"right",trigger:"click",width:"400"},model:{value:t.layoutListVisible,callback:function(e){t.layoutListVisible=e},expression:"layoutListVisible"}},[i("el-row",{attrs:{gutter:24}},t._l(t.layoutList,function(e,n){return i("el-col",{key:n,attrs:{span:12}},[i("el-button",{on:{click:function(e){t.changeLayout(n)}}},[i("img",{attrs:{src:e.url,alt:"layout"+n}})])],1)}))],1),t._v(" "),i("el-container",[i("el-aside",[i("ul",[i("li",[i("el-button",{directives:[{name:"popover",rawName:"v-popover:bg-popup",arg:"bg-popup"}],attrs:{plain:""}},[t._v("更换背景")])],1),t._v(" "),i("li",[i("el-button",{directives:[{name:"popover",rawName:"v-popover:layout-popup",arg:"layout-popup"}],attrs:{plain:""}},[t._v("更换布局")])],1)])]),t._v(" "),i("el-main",[i("my-canvas")],1),t._v(" "),i("el-aside",[i("preview")],1)],1)],1)},B=[],E={render:M,staticRenderFns:B},G=E,N=i("/Xao"),O=o,P=N(A,G,!1,O,"data-v-a21018a4",null),j=P.exports,W={name:"app",components:{cup:j}},X=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("cup")],1)},H=[],K={render:X,staticRenderFns:H},J=K,D=i("/Xao"),Z=r,q=D(W,J,!1,Z,null,null),Q=q.exports;l.default.config.productionTip=!1,l.default.use(c.a),new l.default({el:"#app",template:"<App/>",components:{App:Q},data:{bus:new l.default}})},jSAi:function(t,e){},rK6t:function(t,e){},sUZJ:function(t,e){},wtdT:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.69121633ed7d313eb434.js.map